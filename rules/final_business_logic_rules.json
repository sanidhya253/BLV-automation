{
  "framework": "Business Logic Security Automation Framework",
  "version": "1.0",
  "rules": [

{
  "rules": [
    {
      "rule_id": "BLV-QTY-001",
      "name": "Negative Quantity Rejection",
      "endpoint": "/add-to-cart",
      "parameter": "quantity",
      "condition": ">= 1",
      "severity": "High"
    },
    {
      "rule_id": "BLV-PRICE-001",
      "name": "Price Must Be Positive",
      "endpoint": "/add-to-cart",
      "parameter": "price",
      "condition": "> 0",
      "severity": "High"
    },
    
    {
      "rule_id": "BLV-QTY-002",
      "name": "Quantity Upper Bound Validation",
      "endpoint": "/api/cart/add",
      "expected_behavior": {
        "quantity_maximum": 100
      },
      "severity": "High",
      "description": "Unreasonably large quantities must not be accepted to prevent overflow or abuse."
    },

    {
      "rule_id": "BLV-CPN-001",
      "name": "Single-Use Coupon Enforcement",
      "endpoint": "/api/cart/apply-coupon",
      "expected_behavior": {
        "coupon_reuse_allowed": false
      },
      "severity": "High",
      "description": "Coupons must not be reusable once successfully applied."
    },

    {
      "rule_id": "BLV-CPN-002",
      "name": "Coupon Stacking Prevention",
      "endpoint": "/api/cart/apply-coupon",
      "expected_behavior": {
        "multiple_coupons_allowed": false
      },
      "severity": "Medium",
      "description": "Only one coupon should be applied per order to prevent stacked discounts."
    },

    {
      "rule_id": "BLV-PAY-001",
      "name": "Payment Amount Consistency",
      "endpoint": "/api/payment/initiate",
      "expected_behavior": {
        "amount_source": "server",
        "gateway_amount_must_match_order": true
      },
      "severity": "Critical",
      "description": "Payment gateway amount must match the server-calculated order total."
    },

    {
      "rule_id": "BLV-WF-001",
      "name": "Mandatory Payment Step Enforcement",
      "endpoint": "/api/order/confirm",
      "expected_behavior": {
        "payment_required": true
      },
      "severity": "Critical",
      "description": "Orders must not be confirmed unless successful payment is completed."
    },

    {
      "rule_id": "BLV-WAL-001",
      "name": "Wallet Top-Up Limit Validation",
      "endpoint": "/api/wallet/topup",
      "expected_behavior": {
        "topup_maximum": 50000
      },
      "severity": "High",
      "description": "Wallet top-up amounts must be limited to prevent balance overflow or abuse."
    },

    {
      "rule_id": "BLV-RACE-001",
      "name": "Double Spend Race Condition Prevention",
      "endpoint": "/api/order/place",
      "expected_behavior": {
        "idempotency_required": true
      },
      "severity": "Critical",
      "description": "Duplicate order submissions must not result in multiple orders or inconsistent charges."
    },

    {
      "rule_id": "BLV-DISC-001",
      "name": "Discount Percentage Validation",
      "endpoint": "/api/cart/apply-coupon",
      "expected_behavior": {
        "discount_percentage_maximum": 100
      },
      "severity": "High",
      "description": "Discount values must not exceed 100 percent of the order value."
    },

    {
      "rule_id": "BLV-SHIP-001",
      "name": "Shipping Fee Integrity Validation",
      "endpoint": "/api/checkout",
      "expected_behavior": {
        "shipping_fee_editable": false
      },
      "severity": "Medium",
      "description": "Shipping charges must be calculated server-side and protected from client-side modification."
    },

    {
      "rule_id": "BLV-AUTH-001",
      "name": "Role Escalation Prevention",
      "endpoint": "/api/user/update-profile",
      "expected_behavior": {
        "role_change_allowed": false
      },
      "severity": "Critical",
      "description": "Users must not be able to modify their role or escalate privileges through request parameters."
    }

  ]
}
